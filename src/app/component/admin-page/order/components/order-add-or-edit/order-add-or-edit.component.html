<h2 mat-dialog-title>{{ "Chi tiết đơn hàng"  }}</h2>
<mat-dialog-content class="mat-typography">
  <div>
    <div class="d-flex p-3">
      <label class="align-self-center"> Trạng thái đơn hàng:  </label>
      <div class="flex-column product-new__input align-self-center m-3" >
        <button class="btn btn-outline-secondary dropdown-toggle mt-2 ư"
                type="button" id="dropdownProductLabel"
                data-bs-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false">
          {{selectedStatus ? getStatus(selectedStatus) : '--- Trạng thái ---'}}
        </button>
        <div class="dropdown-menu" aria-labelledby="dropdownProductLabel">
          <a class="dropdown-item" *ngFor="let status of orderStatus"
             (click)="selectOrderStatus(status)">{{getStatus(status)}}</a>
        </div>
      </div>
      <div>
      </div>
    </div>
    <table>
      <tr>
        <td style="height: 50px;width: 400px; border: 1px solid #e5e5e5;padding: 8px;">Mã đơn hàng:</td>
        <td style="height: 50px; border: 1px solid #e5e5e5;font-weight: bold; padding: 8px;">{{order?.id}}
        </td>
      </tr>
      <tr>
        <td style="height: 50px;width: 400px; border: 1px solid #e5e5e5;padding: 8px;">Khách hàng:</td>
        <td style="height: 50px; border: 1px solid #e5e5e5;font-weight: bold; padding: 8px;">
          {{order?.customer.name}}</td>
      </tr>
      <tr>
        <td style="height: 50px;width: 400px; border: 1px solid #e5e5e5;padding: 8px;">Địa chỉ:</td>
        <td style="height: 50px; border: 1px solid #e5e5e5;font-weight: bold; padding: 8px;">
          {{order?.address}}, {{order?.ward}}, {{order?.district}}, {{order?.city}}</td>
      </tr>
      <tr>
        <td style="height: 50px;width: 400px; border: 1px solid #e5e5e5;padding: 8px;">Số điện thoại đặt
          hàng:</td>
        <td style="height: 50px; border: 1px solid #e5e5e5;font-weight: bold; padding: 8px;">
          {{order?.customer.phone}}</td>
      </tr>
      <tr>
        <td style="height: 50px;width: 400px; border: 1px solid #e5e5e5;padding: 8px;">Ngày tạo đơn hàng:
        </td>
        <td style="height: 50px; border: 1px solid #e5e5e5;font-weight: bold; padding: 8px;">
          {{moment(order?.created_date).format('DD-MM-YYYY')}}</td>
      </tr>
      <tr>
        <td style="height: 50px;width: 400px; border: 1px solid #e5e5e5;padding: 8px;">Tổng tiền đơn hàng:
        </td>
        <td style="height: 50px; border: 1px solid #e5e5e5;font-weight: bold; padding: 8px;">{{totalPrice |
          CustomeCurrency}} ₫</td>
      </tr>
      <tr>
        <td style="height: 50px;width: 400px; border: 1px solid #e5e5e5;padding: 8px;">Hình thức thanh toán:
        </td>
        <td style="height: 50px; border: 1px solid #e5e5e5;font-weight: bold; padding: 8px;">
          {{order?.payment_method}}</td>
      </tr>
    </table>

    <table mat-table [dataSource]="dataSource">



      <!-- Image Info Column -->
      <ng-container matColumnDef="images">
        <th mat-header-cell *matHeaderCellDef> Hình Ảnh </th>
        <td mat-cell *matCellDef="let element">
          <ng-container *ngIf="element?.product?.images?.[0]?.path">
            <div class="img-box">
              <img [src]="element?.product?.images?.[0]?.path" alt="">
            </div>
          </ng-container>
        </td>
      </ng-container>

      <!-- Product Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef> Tên Sản Phẩm </th>
        <td mat-cell *matCellDef="let element"> {{element.product.name}} </td>
      </ng-container>

      <!-- Product Category Column -->
      <ng-container matColumnDef="warranty_type">
        <th mat-header-cell *matHeaderCellDef> Loại bảo hành </th>
        <td mat-cell *matCellDef="let element"> {{ element.warranty_type }} tháng </td>
      </ng-container>
      <!-- Product Category Column -->
      <ng-container matColumnDef="quantity">
        <th mat-header-cell *matHeaderCellDef> Số lượng </th>
        <td mat-cell *matCellDef="let element"> {{ element.quantity }} </td>
      </ng-container>

      <!-- Product Category Column -->
      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef> Đơn giá (VND) </th>
        <td mat-cell *matCellDef="let element"> {{ getSelectedPrice(element) | CustomeCurrency }} ₫</td>
      </ng-container>
      <!-- Product Category Column -->
      <ng-container matColumnDef="total_price">
        <th mat-header-cell *matHeaderCellDef> Thành tiền (VND) </th>
        <td mat-cell *matCellDef="let element"> {{ (element.quantity * (getSelectedPrice(element))) | CustomeCurrency }} ₫</td>
      </ng-container>

      <!-- Stock Column -->
      <ng-container matColumnDef="stock">
        <th mat-header-cell *matHeaderCellDef> Số Lượng Còn Lại </th>
        <td mat-cell *matCellDef="let element"> {{element.product.stock}} </td>
      </ng-container>

      <!-- Label Column -->
      <ng-container matColumnDef="label">
        <th mat-header-cell *matHeaderCellDef> Nhãn </th>
        <td mat-cell *matCellDef="let element"> {{element.product.label}} </td>
      </ng-container>


      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>

</mat-dialog-content>
<mat-dialog-actions align="end">
  <div class="button-group d-flex gap-2">
    <button mat-raised-button color="primary" (click)="onSave()">
      <mat-icon>save</mat-icon>
      Lưu
    </button>
    <button mat-raised-button mat-dialog-close>
      <mat-icon>close</mat-icon>
      Đóng
    </button>
  </div>
</mat-dialog-actions>
